---
title: "Modelling infectious disease dynamics with R - week 3"
author: "Roel Bakker, PhD"
date: "4-May-2022"
output:
  slidy_presentation:
    font_adjustment: -1
  ioslides_presentation: default
  beamer_presentation: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

*****
## Agenda 

0. The next occurrence of this course (May 11) will have to be moved to May 18 (?)
   as no conference rooms are available on May 11 ...

1. Link to material for this course: https://bit.ly/infdismodR   
   (please open .html files by right mouse click -> Open With -> Google Chrome or Microsoft Edge)
2. Models of dynamical systems implemented in R with deSolve
   1. Exponential decay
   2. SIR model
   3. TIME Impact core model 
   4. Demo: implementation of TIME impact core model in tbvax
   
3. Assignments for week 4: 
   1. complete the assignment for week 3  
   2. experiment with the tbvax model 

*****************

### 2.1 Exponential Decay

$dy(t)/dt = -k \cdot y(t)$

with $y(t)$ a function of time. 

See expdecay-etc.R

******************

### 2.2 SIR model

Differential equations:

$dS/dt = âˆ’b\cdot c\cdot \frac{I}{N} \cdot S$

$dI/dt =  b\cdot c\cdot \frac{I}{N} \cdot S - \frac{I}{d}$

$dR/dt =   \frac{I}{d}$

with $N=S+I+R$

and  
$b$: transmission probability per contact  
$c$: contact rate (the number of contacts per unit time)  
$d$: duration of the infectious period  

see SIR_model.R

******************

### 2.3 TIME impact model (core model only: no age groups, MDR, treatment history)

![from Tech appendix of BMC Medicine 2016 paper by Houben](SLIN-core.png)

see TIME-core.R  

use the picture above to define the differential equations in the derivs() function ! 

experiment with your model 

*****************
### 2.4 Demo: TIME impact model implemented in tbvax



*****************
### 3.1 Assignment (originally for week 3) [not for the faint of heart :-)]: 

Read the paper by Tom Sumner and Richard White in BMC Infectious Diseases:
https://bmcinfectdis.biomedcentral.com/articles/10.1186/s12879-020-05592-5

including the appendix:
https://static-content.springer.com/esm/art%3A10.1186%2Fs12879-020-05592-5/MediaObjects/12879_2020_5592_MOESM1_ESM.docx

Implement model 1 in deSolve

Research questions:  

- what is the predicted dynamics (i.e. in what time frame would we see an impact) of the impact of TPT on TB disease incidence?  
- what is the predicted dynamics of ACF on TB disease incidence?  
- which intervention would be cheaper (e.g. costs per incident case averted)?  

See also https://roelb54.shinyapps.io/TBvaxdemo/


